<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Deploying an application using Dokku (with https and redirects) - vblinden</title><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="Deploying an application using Dokku (with https and redirects)"><meta itemprop=description content="If you are creating a web application, you have to deploy it at some point. Most of the time I choose a service or provider that manages the server for me and I just have to deploy the application. Think about Heroku, Fortrabbit, Google Cloud, Microsoft Azure or AWS. These services are great and work really well, however they can really add up in cost when you want to scale up an application or have multiple little applications running."><meta itemprop=datePublished content="2020-05-05T13:39:37+02:00"><meta itemprop=dateModified content="2020-05-05T13:39:37+02:00"><meta itemprop=wordCount content="766"><meta itemprop=keywords content="docker,dokku,"><meta property="og:title" content="Deploying an application using Dokku (with https and redirects)"><meta property="og:description" content="If you are creating a web application, you have to deploy it at some point. Most of the time I choose a service or provider that manages the server for me and I just have to deploy the application. Think about Heroku, Fortrabbit, Google Cloud, Microsoft Azure or AWS. These services are great and work really well, however they can really add up in cost when you want to scale up an application or have multiple little applications running."><meta property="og:type" content="article"><meta property="og:url" content="https://vblinden.nl/posts/deploying-an-application-using-dokku-with-https-and-redirects/"><meta property="article:published_time" content="2020-05-05T13:39:37+02:00"><meta property="article:modified_time" content="2020-05-05T13:39:37+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Deploying an application using Dokku (with https and redirects)"><meta name=twitter:description content="If you are creating a web application, you have to deploy it at some point. Most of the time I choose a service or provider that manages the server for me and I just have to deploy the application. Think about Heroku, Fortrabbit, Google Cloud, Microsoft Azure or AWS. These services are great and work really well, however they can really add up in cost when you want to scale up an application or have multiple little applications running."><link href="https://fonts.googleapis.com/css?family=Playfair+Display:700" rel=stylesheet type=text/css><link rel=stylesheet type=text/css media=screen href=https://vblinden.nl/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://vblinden.nl/css/main.css><link id=dark-scheme rel=stylesheet type=text/css href=https://vblinden.nl/css/dark.css><script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script><script src=https://vblinden.nl/js/main.js></script></head><body><div class="container wrapper"><div class=header><h1 class=site-title><a href=https://vblinden.nl/>vblinden</a></h1><div class=site-description><p>software engineering and random stuff blog</p><nav class="nav social"><ul class=flat><li><a href=https://github.com/vblinden title=Github><i data-feather=github></i></a></li><li><a href=https://twitter.com/vblinden title=Twitter><i data-feather=twitter></i></a></li><li><a href=https://www.linkedin.com/in/vincent-van-der-linden-347b5b189 title=LinkedIn><i data-feather=linkedin></i></a></li><li><a href=mailto:blog@vblinden.nl title=Mail><i data-feather=mail></i></a></li><li><a href=/index.xml title=RSS><i data-feather=rss></i></a></li></ul></nav><span class=scheme-toggle><a href=# id=scheme-toggle></a></div><nav class=nav><ul class=flat><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li><li><a href=/tags>Tags</a></li></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>05</span>
<span class=rest>May 2020</span></div></div><div class=matter><h1 class=title>Deploying an application using Dokku (with https and redirects)</h1></div></div><div class=markdown><p>If you are creating a web application, you have to deploy it at some point. Most of the time I choose a service or provider that manages the server for me and I just have to deploy the application. Think about <a href=https://www.heroku.com/>Heroku</a>, <a href=https://www.fortrabbit.com/>Fortrabbit</a>, <a href=https://cloud.google.com/>Google Cloud</a>, <a href=https://azure.microsoft.com/en-us/>Microsoft Azure</a> or <a href=https://aws.amazon.com/>AWS</a>. These services are great and work really well, however they can really add up in cost when you want to scale up an application or have multiple little applications running.</p><p>This is why I recently purchased a Virtual Private Server (VPS), they are a lot cheaper (cheap as in $2.50 a month!) then the providers mentioned above. This is of course if you are not taking in account that these providers also offer a free tier for some of their services (mostly you can have one single application at most though).</p><p>The only downside to this is that you have to manage the server yourself and that can be a real hassle if you don&rsquo;t have much experience and knowledge about managing a server. Luckily there are a lot of tutorials for <a href=https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-20-04>initial server setup</a> out there which you can follow. Don&rsquo;t forget to install the <code>unattended-upgrades</code> package (if you are using Ubuntu), enable a firewall and you will be fine (I am <strong>not</strong> an expert on server management or security, so please don&rsquo;t quote me on this).</p><p>Anyway, the real pain is to manage and install every single application and it&rsquo;s dependencies. For example: when you are hosting a PHP application with Nginx as the webserver you have to install PHP, Composer (for package management), Nginx and PHP-FPM. If you have some front-end dependencies like Vue.js with Webpack you also have to install Node.js and maintain those packages.</p><p>Luckily for me (and you), we have <a href=https://www.docker.com/>Docker</a> these days which makes it much easier to manage all these stuff because each application will have it&rsquo;s own <code>Dockerfile</code> or <code>docker-compose.yml</code> file which will handle everything that is needed to run the application correctly. This is a much better approach already, except now we aren&rsquo;t managing dependencies directly but we are managing containers. Worrying about what will happen when a container will fall over, will it restart correctly, what happens if my database container fails, etc.</p><p>This is where <a href=https://github.com/dokku/dokku>Dokku</a> gets in the picture. Dokku describes itself as &ldquo;a Docker powered mini-Heroku&rdquo;, and it really is as easy to use as Heroku. It will take care of all server related stuff, like managing dependencies, using SSL with Let&rsquo;s Encrypt, redirects of domains etc. But at the same time it will allow us to define our own <code>Dockerfile</code> which will give us more room to customize the way our application is handled by Dokku.</p><p>I always use the following commands to get Dokku up and running with an application using the <a href=https://github.com/dokku/dokku/blob/master/docs/deployment/methods/buildpacks.md>Buildpacks</a> that Dokku supports at the moment.</p><p>To install Dokku on your server, you should follow the <a href=http://dokku.viewdocs.io/dokku/getting-started/installation/>official documentation</a>. They also have a <a href=http://dokku.viewdocs.io/dokku/deployment/application-deployment/>great guide</a> for deploying your first application.</p><p>When Dokku is installed we can create a new app by executing the following commands on your server. This will tell Dokku we want to create a new application with the name <code>appname</code> and assign two domains to it: <code>example.com</code> and <code>www.example.com</code>.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>dokku apps:create appname
dokku domains:add appname example.com
dokku domains:add appname www.example.com
</code></pre></div><p>You application should now be reachable at <code>example.com</code> and <code>www.example.com</code> if you have updated your DNS records correctly. Next thing we need to tell Dokku to use SSL. Dokku doesn&rsquo;t support Let&rsquo;s Encrypt certificates out of the box, so we need to install a <a href=https://github.com/dokku/dokku-letsencrypt>plugin</a> for it. Execute the following commands on your server.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:green># Install the plugin:</span>
sudo dokku plugin:install https://github.com/dokku/dokku-letsencrypt.git 

<span style=color:green># Tell Let&#39;s Encrypt which email to use:</span>
dokku config:set --global DOKKU_LETSENCRYPT_EMAIL=test@example.com 

<span style=color:green># Enable Let&#39;s Encrypt for our application:</span>
dokku letsencrypt appname 
</code></pre></div><p>Congratulations your application now uses SSL certificates from Let&rsquo;s Encrypt. The last thing we need to do is to tell Dokku that we want the redirect the <code>example.com</code> domain to the <code>www.example.com</code> domain, so we don&rsquo;t have double content on the internet. We also have to install a <a href=https://github.com/dokku/dokku-redirect>plugin</a> to make it work.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:green># Install the plugin:</span>
dokku plugin:install https://github.com/dokku/dokku-redirect.git

<span style=color:green># Redirect example.com to www.example.com:</span>
dokku redirect:set appname example.com www.example.com
</code></pre></div><p>That&rsquo;s it! You now have a application running on a server using Let&rsquo;s Encrypt SSL certificates and redirecting the root domain <code>example.com</code> to the subdomain <code>www.example.com</code>.</p><p>In a next blog post I will show you how to use a custom <code>Dockerfile</code> and use it with Dokku. If you want to read more about that already, you can check out the <a href=http://dokku.viewdocs.io/dokku/deployment/methods/dockerfiles/>Dokku documentation</a>.</p></div><div class=tags><ul class=flat><li><a href=/tags/docker>docker</a></li><li><a href=/tags/dokku>dokku</a></li></ul></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")
return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='vblinden-blog';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the</a></noscript><a href=http://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div class="footer wrapper"><nav class=nav><div>2020 © vblinden | <a href=https://github.com/knadh/hugo-ink>Ink</a> theme on <a href=https://gohugo.io>Hugo</a></div></nav></div><script>feather.replace()</script></body></html>